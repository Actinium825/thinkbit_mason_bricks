# pusher_service

[![Powered by Mason](https://img.shields.io/endpoint?url=https%3A%2F%2Ftinyurl.com%2Fmason-badge)](https://github.com/felangel/mason)

A brick created with [Mason CLI][1] to generate `pusher_service.dart` for real-time applications via [Pusher Channels][9].

_Generated by [mason][1] ðŸ§±_

## Getting Started ðŸš€

1. Make sure Mason CLI is activated
   `dart pub global activate mason_cli`
2. Initialize mason using this command inside your project root directory:
   `mason init`
3. Add this brick to your project by editing the `mason.yaml` file and adding these lines under the `bricks`:

   ```
   pusher_service:
       git:
       url: https://github.com/thinkbit/thinkbit_mason_bricks.git
       path: bricks/pusher_service
   ```

   or just run

   ```
   mason add apusher_service --git-url https://github.com/thinkbit/thinkbit_mason_bricks.git --git-path bricks/pusher_service
   ```

4. Get the brick from the repository using this command:
   `mason get`
5. Generate the code using this command:
   `mason make pusher_service`
6. To use `pusher_service.dart`, configure the following parameters in your config file:

   ```dart
   // Example configuration
   static final String _host = 'ws-ap1.pusher.com';    // Pusher websocket host
   static final String _scheme = 'wss';                 // Connection scheme (wss/ws)
   static final String _key = 'your-pusher-key-here';  // Your Pusher app key
   static final int _port = 443;                       // Connection port (443 for SSL)

   static final String _baseUrl = 'https://your-api.com';  // Your backend API URL
   static final Uri _authEndpoint = Uri.parse('$_baseUrl/api/admin/broadcasting/auth');
   ```

## Usage Examples

### Initialize Service

```dart
await PusherService().init();
```

### Public Channels

```dart
// Subscribe to private channel
final privateChannel = await PusherService().subscribeToPrivate(
  'private-chat',
  'message.sent',
  (event) => print('New message: ${event.data}'),
);
```

### Private Channels

```dart
// Subscribe to private channel
final privateChannel = await PusherService().subscribeToPrivate(
  'private-chat',
  'message.sent',
  (event) => print('New message: ${event.data}'),
);
```

### Presence Channels

```dart
// Subscribe to presence channel
final presenceChannel = await PusherService().subscribeToPresence(
  'room-1',
  onSubscribed: (event) => print('Joined: ${event.data}'),
  onMemberAdded: (event) => print('Member joined: ${event.data}'),
  onMemberRemoved: (event) => print('Member left: ${event.data}'),
);
```

### Unsubscribe from Channels

```dart
// Unsubscribe from public channel
PusherService().unsubPublic(publicChannel);

// Unsubscribe from private channel
PusherService().unsubPrivate(privateChannel);

// Unsubscribe from presence channel
PusherService().unsubPresence(presenceChannel);
```

### Dispose Service

```dart
PusherService().dispose();
```

A few resources to get you started if this is your first brick template:

- [Official Mason Documentation][2]
- [Code generation with Mason Blog][3]
- [Very Good Livestream: Felix Angelov Demos Mason][4]
- [Flutter Package of the Week: Mason][5]
- [Observable Flutter: Building a Mason brick][6]
- [Meet Mason: Flutter Vikings 2022][7]

[1]: https://github.com/felangel/mason
[2]: https://docs.brickhub.dev
[3]: https://verygood.ventures/blog/code-generation-with-mason
[4]: https://youtu.be/G4PTjA6tpTU
[5]: https://youtu.be/qjA0JFiPMnQ
[6]: https://youtu.be/o8B1EfcUisw
[7]: https://youtu.be/LXhgiF5HiQg
[8]: https://pub.dev/packages/dart_pusher_channels
[9]: https://pusher.com/channels/
